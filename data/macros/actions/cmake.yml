actions:

    # Perform cmake with the default options in a subdirectory
    - cmake: |
        cmake %(options_cmake)

    # Perform cmake with unity build enabled
    - cmake_unity: |
        cmake -DCMAKE_UNITY_BUILD=ON %(options_cmake)

    # Build the cmake project
    - cmake_build: |
        ninja -v -j "%(jobs)" -C "%(builddir)"

    # Install results of the build to the destination directory
    - cmake_install: |
        DESTDIR="%(installroot)" ninja install -v -j "%(jobs)" -C "%(builddir)"

definitions:

    # Default cmake options as passed to cmake
    - options_cmake: |
        -G Ninja . -B "%(builddir)" \
        -DCMAKE_C_FLAGS="%(cflags)" \
        -DCMAKE_CXX_FLAGS="%(cxxflags)" \
        -DCMAKE_LD_FLAGS="%(ldflags)" \
        -DCMAKE_BUILD_TYPE="Release" \
        -DCMAKE_INSTALL_LIBDIR="lib" \
        -DCMAKE_INSTALL_PREFIX="%(prefix)" \
        -DCMAKE_LIB_SUFFIX="%(libsuffix)"
